events {}

http {
    server {
        listen 8080;

        root /usr/share/nginx/html;
        index index.html;

        location / {
            try_files $uri $uri/ /index.html;

            # --- HEADER CLEARING ---
            add_header X-Frame-Options "";
            add_header X-Content-Type-Options "";
            add_header X-XSS-Protection "";
            add_header Content-Security-Policy ""; # Clear any previous CSP directives

            # --- EXPLICIT FRAME-ANCESTORS POLICY ---
            # This must be the ONLY frame-ancestors directive.
            # 'self' allows embedding from your Cloud Run domain itself.
            # https://sites.google.com is needed if Google Sites creates its own internal frame,
            # but MOST IMPORTANTLY, we need to allow YOUR CUSTOM DOMAIN.
            add_header Content-Security-Policy "frame-ancestors 'self' https://sites.google.com https://www.learniamo.com;" always;

            # If you are serving content from www.learniamo.com on Google Sites,
            # this is the critical addition.
        }
    }
}
